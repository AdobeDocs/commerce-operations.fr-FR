---
title: 'La requête ACSD-68356: [!DNL GraphQL] cart renvoie un montant de remise incorrect pour les devis virtuels'
description: Appliquez le correctif ACSD-68356 pour résoudre le problème d’Adobe Commerce où la requête  [!DNL GraphQL]  panier renvoie un montant de remise incorrect pour les devis virtuels.
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356 : [!DNL GraphQL] requête de panier renvoie un montant de remise incorrect pour les devis virtuels

Le correctif ACSD-68356 corrige le problème où [!DNL GraphQL] requête de panier renvoie un montant de remise incorrect pour les devis virtuels. Ce correctif est disponible lorsque la version 1.1.73 de [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) est installée. L’ID du correctif est ACSD-68356. Notez que ce problème doit être résolu dans Adobe Commerce 2.4.9.

## Produits et versions concernés

**Le correctif est créé pour la version Adobe Commerce :**

* Adobe Commerce (toutes les méthodes de déploiement) 2.4.8-p2

**Compatible avec les versions d’Adobe Commerce :**

* Adobe Commerce (toutes les méthodes de déploiement) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>Le correctif peut s’appliquer à d’autres versions avec de nouvelles versions de [!DNL Quality Patches Tool]. Pour vérifier si le correctif est compatible avec votre version d’Adobe Commerce, mettez à jour le package `magento/quality-patches` vers la dernière version et vérifiez la compatibilité sur la page [[!DNL Quality Patches Tool] : Rechercher des correctifs](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=fr). Utilisez l’ID du correctif comme mot-clé de recherche pour localiser le correctif.

## Problème

Les requêtes de panier [!DNL GraphQL] renvoient des montants de remise incorrects pour les devis virtuels, en appliquant des remises à des produits virtuels non éligibles.

<u>Procédure à suivre </u> :

1. Créez deux produits virtuels :
   1. SKU `virtual1`
   1. SKU `virtual2`
1. Créez une règle de prix de panier :
   1. Définir pour appliquer automatiquement, sans coupon.
   1. Actions :
   1. Pourcentage de remise sur le prix du produit - 20 %.
   1. S’applique uniquement aux articles du panier pour lesquels le SKU est `virtual2`.
1. Ajoutez des produits à un devis vide récent via storefront :
   1. Ajoutez d’abord `virtual1` SKU.
   1. Ajoutez `virtual2` SKU en seconde.
1. Obtenez les détails du panier à l’aide de la requête [!DNL GraphQL] suivante :

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Cochez **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Résultats attendus</u> :

* `virtual1` SKU n’a aucune remise répertoriée dans [!DNL GraphQL]
* `virtual2` SKU bénéficie d’une remise répertoriée dans [!DNL GraphQL]

<u>Résultats réels</u> :

* `virtual1` et `virtual2` affichent incorrectement le même montant de remise dans la réponse [!DNL GraphQL].

## Application du correctif

Pour appliquer des correctifs individuels, utilisez les liens suivants en fonction de votre méthode de déploiement :

* Adobe Commerce ou Magento Open Source On-premise : [[!DNL Quality Patches Tool] > Utilisation](/help/tools/quality-patches-tool/usage.md) dans le guide de [!DNL Quality Patches Tool].
* Adobe Commerce sur les infrastructures cloud : [Mises à niveau et correctifs > Appliquer des correctifs](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=fr) dans le guide Commerce sur les infrastructures cloud .

## Lecture connexe

Pour en savoir plus sur [!DNL Quality Patches Tool], consultez :

* [[!DNL Quality Patches Tool] : un outil en libre-service pour les correctifs de qualité](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) dans le guide Outils .
